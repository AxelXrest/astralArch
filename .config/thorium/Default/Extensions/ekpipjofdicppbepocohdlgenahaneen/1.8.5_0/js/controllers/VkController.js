!function e(t,o,s){function r(l,a){if(!o[l]){if(!t[l]){var n="function"==typeof require&&require;if(!a&&n)return n(l,!0);if(i)return i(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var u=o[l]={exports:{}};t[l][0].call(u.exports,(function(e){return r(t[l][1][e]||e)}),u,u.exports,e,t,o,s)}return o[l].exports}for(var i="function"==typeof require&&require,l=0;l<s.length;l++)r(s[l]);return r}({1:[function(e,t,o){"use strict";var s,r,i,l,a,n;l=e("../modules/SKLog.js"),a=e("MouseEventController"),n=e("../modules/SimpleMutationObserver.js"),document.getElementById("top_notify_btn")?(l("[VK] New ui detected"),s={headerPlayer:"#top_audio_player",headerPlayerEnabled:"#top_audio_player.top_audio_player_enabled",headerPlayerIcon:"#top_audio",playerPanelPlay:".audio_page_player_play"},r=new a({siteName:"VK Music",playPause:"#top_audio_player.top_audio_player_enabled .top_audio_player_play",playNext:"#top_audio_player.top_audio_player_enabled .top_audio_player_next",playPrev:"#top_audio_player.top_audio_player_enabled .top_audio_player_prev",playState:"#top_audio_player.top_audio_player_enabled.top_audio_player_playing",song:"#top_audio_player.top_audio_player_enabled .top_audio_player_title"}),i=new n(r.doc()),r.playPause=function(){var e=this;return i.isEnabled(s.headerPlayerEnabled)?a.prototype.playPause.call(e):i.isEnabled(s.playerPanelPlay)?e.click({selectorButton:s.playerPanelPlay}):(i.once(s.playerPanelPlay,"inserted",(function(){e.click({selectorButton:s.playerPanelPlay}),e.mousedown({selectorButton:s.headerPlayer})})),e.mouseover({selectorButton:s.headerPlayerIcon}),void e.mousedown({selectorButton:s.headerPlayerIcon}))}):(l("[VK] New ui not detected"),r=new a({siteName:"VK Music",playPause:"#gp_play",playNext:(s={headerPlayButton:"#head_play_btn",playerPanel:"#gp",playerPanelInfo:"#gp_info",playerPanelNext:"#pd_next",playerPanelPrev:"#pd_prev"}).playerPanelNext,playPrev:s.playerPanelPrev,playState:"#gp_play.playing",artist:"#gp_performer",song:"#gp_title"}),i=new n(r.doc()),r.initWaitAndClose=function(e,t,o){var r=this;e=e||s.playerPanelInfo,t=t||s.headerPlayButton,i.once(e,"inserted",(function(){o&&r.click({selectorButton:e}),r.click({selectorButton:s.playerPanelInfo})})),r.click({selectorButton:t})},r.playPause=function(){if(i.isEnabled(s.playerPanel))return a.prototype.playPause.call(this);this.initWaitAndClose()},r.playNext=function(){if(i.isEnabled(s.playerPanelNext))return a.prototype.playNext.call(this);this.initWaitAndClose(s.playerPanelNext,s.playerPanelInfo,!0)},r.playPrev=function(){if(i.isEnabled(s.playerPanelPrev))return a.prototype.playPrev.call(this);this.initWaitAndClose(s.playerPanelPrev,s.playerPanelInfo,!0)},r.getStateData=function(){var e=a.prototype.getStateData.call(this);return i.isEnabled(s.playerPanel)&&(e.canPlayPrev=!0,e.canPlayNext=!0),e})},{"../modules/SKLog.js":5,"../modules/SimpleMutationObserver.js":6,MouseEventController:3}],2:[function(e,t,o){"use strict";!function(){var o=e("../modules/SKLog.js");function s(e){this.siteName=e.siteName||null,this.selectors={playPause:e.playPause||null,play:e.play||null,pause:e.pause||null,playNext:e.playNext||null,playPrev:e.playPrev||null,mute:e.mute||null,like:e.like||null,confirmLike:e.confirmLike||null,dislike:e.dislike||null,confirmDislike:e.confirmDislike||null,iframe:e.iframe||null,playState:e.playState||null,song:e.song||null,artist:e.artist||null,album:e.album||null,art:e.art||null,currentTime:e.currentTime||null,totalTime:e.totalTime||null},Object.defineProperties(this.selectors,Object.keys(this.selectors).reduce(function(e,t){var o=this.selectors[t];return"function"==typeof o&&(e[t]={get:o.bind(this)}),e}.bind(this),{})),this.oldState={},this.buttonSwitch=e.buttonSwitch||!1,this.attachListeners(),this.hidePlayer=e.hidePlayer||!1,this.overridePlayPrev=e.overridePlayPrev||!1,this.overridePlayPause=e.overridePlayPause||!1,this.overridePlayNext=e.overridePlayNext||!1,chrome.runtime.sendMessage({created:!0},(function(){o("SK content script loaded")}))}s.prototype.doc=function(){var e=document;return this.selectors.iframe&&document.querySelector(this.selectors.iframe)&&document.querySelector(this.selectors.iframe).tagName.indexOf("FRAME")>-1&&(e=document.querySelector(this.selectors.iframe).contentWindow.document),e},s.prototype.injectScript=function(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),e.url&&t.setAttribute("src",chrome.extension.getURL(e.url)),e.script&&(t.innerHTML=e.script),(document.head||document.documentElement).appendChild(t)},s.prototype.click=function(e){if(null!==(e=e||{}).selectorButton){try{this.doc().querySelector(e.selectorButton).click(),o(e.action)}catch(t){o("Element not found for click.",e.selectorButton,!0)}this.updatePlayerState()}else o("disabled",e.action)},s.prototype.playPause=function(){null!==this.selectors.play&&null!==this.selectors.pause?this.isPlaying()?this.click({action:"playPause",selectorButton:this.selectors.pause,selectorFrame:this.selectors.iframe}):this.click({action:"playPause",selectorButton:this.selectors.play,selectorFrame:this.selectors.iframe}):this.click({action:"playPause",selectorButton:this.selectors.playPause,selectorFrame:this.selectors.iframe})},s.prototype.playNext=function(){this.click({action:"playNext",selectorButton:this.selectors.playNext,selectorFrame:this.selectors.iframe})},s.prototype.playPrev=function(){this.click({action:"playPrev",selectorButton:this.selectors.playPrev,selectorFrame:this.selectors.iframe})},s.prototype.stop=function(){this.isPlaying()&&this.playPause()},s.prototype.mute=function(){this.click({action:"mute",selectorButton:this.selectors.mute,selectorFrame:this.selectors.iframe})},s.prototype.like=function(){if(this.click({action:"like",selectorButton:this.selectors.like,selectorFrame:this.selectors.iframe}),null!==this.selectors.confirmLike){var e=this;new MutationObserver((function(){this.disconnect(),e.click({action:"confirmLike",selectorButton:e.selectors.confirmLike,selectorFrame:e.selectors.iframe})})).observe(document.documentElement,{childList:!0,subtree:!0})}},s.prototype.dislike=function(){if(this.click({action:"dislike",selectorButton:this.selectors.dislike,selectorFrame:this.selectors.iframe}),null!==this.selectors.confirmDislike){var e=this;new MutationObserver((function(){this.disconnect(),e.click({action:"confirmDislike",selectorButton:e.selectors.confirmDislike,selectorFrame:e.selectors.iframe})})).observe(document.documentElement,{childList:!0,subtree:!0})}},s.prototype.isPlaying=function(){var e=this.doc().querySelector(this.selectors.play),t=!1;if(this.buttonSwitch)t=null===e;else if(this.selectors.playState){var o=this.doc().querySelector(this.selectors.playState);t=!(!o||"none"===window.getComputedStyle(o,null).getPropertyValue("display"))}else e&&(t="none"===window.getComputedStyle(e,null).getPropertyValue("display"));return t},s.prototype.updatePlayerState=function(){this.checkPlayer&&this.checkPlayer();var e=this.getStateData();JSON.stringify(e)!==JSON.stringify(this.oldState)&&(o("Player state change"),this.getSongChanged(e)&&chrome.runtime.sendMessage({action:"send_change_notification",stateData:e}),this.oldState=e,chrome.runtime.sendMessage({action:"update_player_state",stateData:e}))},s.prototype.getStateData=function(){return{song:null===this.getSongData(this.selectors.song)?null:this.getSongData(this.selectors.song).replace(/\s+/g," "),artist:null===this.getSongData(this.selectors.artist)?null:this.getSongData(this.selectors.artist).replace(/\s+/g," "),album:null===this.getSongData(this.selectors.album)?null:this.getSongData(this.selectors.album).replace(/\s+/g," "),art:this.getArtData(this.selectors.art),currentTime:this.getSongData(this.selectors.currentTime),totalTime:this.getSongData(this.selectors.totalTime),isPlaying:this.isPlaying(),siteName:null==this.siteName?null:this.siteName.replace(/\s+/g," "),canDislike:!(!this.selectors.dislike||!this.doc().querySelector(this.selectors.dislike)),canPlayPrev:this.overridePlayPrev||!(!this.selectors.playPrev||!this.doc().querySelector(this.selectors.playPrev)),canPlayPause:this.overridePlayPause||!!(this.selectors.playPause&&this.doc().querySelector(this.selectors.playPause)||this.selectors.play&&this.doc().querySelector(this.selectors.play)||this.selectors.pause&&this.doc().querySelector(this.selectors.pause)),canPlayNext:this.overridePlayNext||!(!this.selectors.playNext||!this.doc().querySelector(this.selectors.playNext)),canLike:!(!this.selectors.like||!this.doc().querySelector(this.selectors.like)),hidePlayer:this.hidePlayer}},s.prototype.getSongChanged=function(e){return this.oldState&&e&&this.oldState.song!==e.song},s.prototype.getSongData=function(e){if(!e)return null;var t=this.doc().querySelector(e);return t&&t.textContent?t.textContent:null},s.prototype.getArtData=function(e){if(!e)return null;var t=this.doc().querySelector(e);return t&&t.attributes&&t.attributes.src?t.attributes.src.value:null},s.prototype.doRequest=function(e,t,o){if(void 0!==e&&("playPause"===e.action&&this.playPause(),"playNext"===e.action&&this.playNext(),"playPrev"===e.action&&this.playPrev(),"stop"===e.action&&this.stop(),"mute"===e.action&&this.mute(),"like"===e.action&&this.like(),"dislike"===e.action&&this.dislike(),"playerStateNotify"===e.action&&chrome.runtime.sendMessage({action:"send_change_notification",stateData:this.getStateData()}),"getPlayerState"===e.action)){var s=this.getStateData();this.oldState=s,o(s)}},s.prototype.attachListeners=function(){chrome.runtime.onMessage.addListener(this.doRequest.bind(this)),setInterval(this.updatePlayerState.bind(this),200),o("Attached listener for ",this)},t.exports=s}()},{"../modules/SKLog.js":5}],3:[function(e,t,o){"use strict";!function(){var o=e("BaseController"),s=e("../modules/MouseEventDispatcher.js"),r=e("../modules/SKLog.js");function i(){o.apply(this,arguments)}i.prototype=Object.create(o.prototype),i.prototype.constructor=i,s.eachTypes((function(e){Object.prototype.hasOwnProperty.call(o.prototype,e)||(i.prototype[e]=function(t,o){if(null!==(t=t||{}).selectorButton){try{var i=this.doc().querySelector(t.selectorButton);s.dispatch(i,e,o),t.action&&r(t.action)}catch(o){r("Element not found for "+e+".",t.selectorButton,!0)}this.updatePlayerState()}else r("disabled",t.action)})})),t.exports=i}()},{"../modules/MouseEventDispatcher.js":4,"../modules/SKLog.js":5,BaseController:2}],4:[function(e,t,o){"use strict";!function(){function e(){throw"MouseEventDispatcher cannot be instantiated."}e.eventTypes=["mouseclick","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup"],e.dispatch=function(e,t,o){"string"==typeof e&&(e=document.querySelector(e)),"mouseclick"===t&&(t="click"),o=o||{};var s=document.createEvent("MouseEvents");s.initMouseEvent(t,o.canBubble||!0,o.cancelable||!0,o.view||window,o.detail||1,o.screenX||0,o.screenY||0,o.clientX||0,o.clientY||0,o.ctrlKey||!1,o.altKey||!1,o.shiftKey||!1,o.metaKey||!1,o.button||0,o.relatedTarget||null),e.dispatchEvent(s)},e.eachTypes=function(e){for(var t=0;t<this.eventTypes.length;t++)e(this.eventTypes[t])},e.eachTypes((function(t){e[t]=function(o,s){e.dispatch(o,t,s)}})),t.exports=e}()},{}],5:[function(e,t,o){"use strict";t.exports=function(e,t,o){e&&(t=t||"",o?(console.error("STREAMKEYS-ERROR: "+e,t),e="ERROR: "+e):console.log("STREAMKEYS-INFO: "+e,t))}},{}],6:[function(e,t,o){"use strict";var s;(s=function(e){var t=this;t.node=e,t.selectors={},t.handlers={},t.observer=new MutationObserver((function(){for(var e in t.selectors){var o=t.isEnabled(e),s=t.checkEnabled(e);t.selectors[e]=s,o!=s&&t.deferredTrigger(e,s?"inserted":"removed")}})),t.observer.observe(t.node,{childList:!0,subtree:!0,attributes:!0})}).prototype.trigger=function(e,t){var o=this;if(!t||!o.handlers[e]||!o.handlers[e][t])return!1;var s=o.handlers[e][t].filter((function(e){var t=!1;try{t=e()}catch(e){t=!1}return!1!==t}));o.handlers[e][t]=s},s.prototype.deferredTrigger=function(e,t){var o=this;setTimeout((function(){o.trigger(e,t)}),0)},s.prototype.on=function(e,t,o){e&&t&&o&&(this.handlers[e]=this.handlers[e]||{},this.handlers[e][t]=this.handlers[e][t]||[],this.handlers[e][t].push(o))},s.prototype.once=function(e,t,o){e&&t&&o&&this.on(e,t,(function(){return o(),!1}))},s.prototype.checkEnabled=function(e){return Boolean(this.node.querySelector(e))},s.prototype.addSelector=function(e){Object.prototype.hasOwnProperty.call(this.selectors,e)||(this.selectors[e]=this.checkEnabled(e))},s.prototype.removeSelector=function(e){Object.prototype.hasOwnProperty.call(this.selectors,e)&&(delete this.selectors[e],delete this.handlers[e])},s.prototype.isEnabled=function(e){return this.addSelector(e),this.selectors[e]},t.exports=s},{}]},{},[1]);